/*! Thrive Content Builder - 2015-10-08
* http://www.thrivethemes.com/
* Copyright (c) 2015 Thrive Themes */
var TVE_Content_Builder=TVE_Content_Builder||{};!function(a){var b="tve_brdr_none tve_brdr_dotted tve_brdr_dashed tve_brdr_solid tve_brdr_double tve_brdr_groove tve_brdr_ridge tve_brdr_inset tve_brdr_outset";TVE_Content_Builder.controls={dropdown_menus:function(){var b=null,c={};a(".tve_option_separator").on("mousedown",function(a){}).on("click",function(d){c.inner=!0;var e=a(d.target),f=a(this),g=a("#tve_cpanel");if(e.is(".wp-color-picker, .tve_link, .tve_no_click")||e.parents(".tve_no_click").length)return!0;if(d.preventDefault(),a(".active_sub_menu").not(f.find(".active_sub_menu")).hide(),e.hasClass("tve_click")||e.parents(".tve_click").length||!e.parents(".active_sub_menu").length){var h=f.find(".tve_sub");h.is(":visible")?(h.hide().trigger("tve.hide_sub_menu").addClass("active_sub_menu"),b=null):((h.find(".tve_color_picker").length||h.find(".text_colour_picker").length)&&TVE_Content_Builder.colors.refresh(),h.show().addClass("active_sub_menu"),b=f),tve_check_submenu_position(h),g.hasClass("tve_editor_collapse")&&g.addClass("expand_width")}g.find(".tve_sub :visible").length||g.removeClass("expand_width"),window.textSel}),a(document).on("click.remove_submenu",function(d){if(c.inner)return void(c.inner=!1);if(b){var e=a(d.target);e.closest(".tve_oparator").first().is(b)||(hide_sub_menu(),a("#tve_cpanel").removeClass("expand_width"))}})},prevent_default:function(a,b,c){c.preventDefault()},rangy_cls:function(a,b,c,d){c.preventDefault();var e={bold_text:rangy.createCssClassApplier("bold_text",{normalize:!0}),italic_text:rangy.createCssClassApplier("italic_text",{normalize:!0}),underline_text:rangy.createCssClassApplier("underline_text",{normalize:!1}),strikethrough_text:rangy.createCssClassApplier("strikethrough_text",{normalize:!1})};"undefined"==typeof d&&(d=a.attr("data-command")+"_text");var f=rangy.getSelection(),g=f.getRangeAt(0);g&&g.toString().length?(e[d].toggleRange(g),f.removeAllRanges(),f.addRange(g)):jQuery(".edit_mode").toggleClass(d)},save_selection:function(a,b,c){var d=rangy.getSelection(),e=d.getAllRanges();e.length&&e[0].startContainer&&jQuery(e[0].startContainer).parents("#tve_editor").length&&(window[a.attr("data-key")]=rangy.saveSelection())},font_size:function(a,b,c){if(b.is(".thrv_post_grid")){var d=b.tve_post_grid(),e=parseInt(a.val()),f=e>=70?"rfs":"";f+=e>=30?" rft":"",b.find(".tve-post-grid-title").css("font-size",a.val()+"px").removeClass("rft rfs").addClass(f),d.config().update(a.val(),"font-size"),d.config().update(f,"item_title_class"),d.after_render()}else if(b.is(".tve_lg_submit")){var g=tve_handle_integer_or_float(a.val());b.css("font-size",g).find("button").css("font-size",g)}else if(b.is(".thrv_social_custom")){var g=tve_handle_integer_or_float(a.val());b.find(".tve_social_items").css("font-size",g+"px")}},height:function(a,b,c){if(b.is(".thrv_post_grid")){var d=b.tve_post_grid(),e=parseInt(a.val());d.config().update(a.val(),"image-height"),b.find(".tve_post_grid_image_wrapper").css("height",e+"px"),d.after_render()}},text_unlink:function(b,c,d){var e=a(".tve_active_hyperlink");e.replaceWith(e.html()),tve_hide_hyperlink_options(),window.linkSel&&rangy.restoreSelection(window.linkSel),jQuery(".tve_quick_link_input").val(""),jQuery(".quick_link_content_table").html(""),jQuery(".lb_quick_link_target").prop("checked",tve_path_params.lb_ql_link_target),jQuery(".lb_quick_link_no_follow").prop("checked",tve_path_params.lb_ql_no_follow)},lb_close:function(b){a("#tve_lightbox_frame").hasClass("revision_mananger_lightbox")&&a("#tve_lightbox_frame").removeClass("revision_mananger_lightbox"),a("#tve_lightbox_overlay, #tve_lightbox_frame").hide().trigger("lb-close"),jQuery("body, html").removeClass("tve-hide-overflow"),a(".tve_active_lightbox").removeClass("tve_active_lightbox"),b&&b.hasClass("tve_mce_close")&&tve_hide_tinymce_popup()},lb_open:function(a,b,c){c.preventDefault(),c.stopPropagation(),a.hasClass("tve_btn")?b.is(editable_elements)?b.addClass("tve_active_lightbox"):b.closest(".thrv_wrapper").addClass("tve_active_lightbox"):a.closest(".thrv_wrapper").addClass("tve_active_lightbox"),tve_open_lightbox(a)},lb_save:function(a){var b=a.hasClass("tve_mce_save")?{tve_lb_type:"shortcode"}:tve_get_lightbox_options();tve_handle_lightbox_options(b)&&TVE_Content_Builder.controls.lb_close(),arguments[2]&&(arguments[2].preventDefault&&arguments[2].preventDefault(),arguments[2].stopPropagation&&arguments[2].stopPropagation())},set_global_flag:function(a){tve_path_params.tve_globals[a.attr("data-flag")]=a.is(":checked")?a.val():0},click:{css:function(a,b){a.attr("data-elem")&&(b=b.find(a.attr("data-elem"))),b.css(a.attr("data-prop"),a.attr("data-val"))},text_align:function(a,b){b.is(".tve_ct_title")?b=b.parents(".thrv_contents_table"):b.is(".thrv_tw_qs_button_text")&&(b=b.parents(".thrv_tw_qs_button")),b.removeClass("tve_p_left tve_p_right tve_p_center tvealignjustify").addClass(a.attr("data-cls"))},block_change:function(b,c,d){var e=b.attr("data-tag"),f=a("<"+e+" class='edit_mode'>"+c.html()+"</"+e+">");c.replaceWith(f),TVE_Content_Builder.drag.bind_draggable(f),d.target=c,convert_element_into_edit_mode(a(".edit_mode"),d),tve_set_selected_dropdown(b)},more_link:function(b,c){a(".tve_more_tag").remove();var d=a('<p class="tve_more_tag"><span class="tve_no_edit">More...</span></p>');a(c).after(d),TVE_Content_Builder.drag.after_clone(c,d)},image_unlink:function(b,c,d){a(c).parents("a").replaceWith(c),b.parent().hide(),jQuery(".tve_quick_link_input").val(""),jQuery(".quick_link_content_table").html(""),jQuery(".lb_quick_link_target").prop("checked",tve_path_params.lb_ql_link_target),jQuery(".lb_quick_link_no_follow").prop("checked",tve_path_params.lb_ql_no_follow)},add_class:function(c,d,e){var f=c.attr("data-cls")?c.attr("data-cls"):c.attr("id");switch(c.data("type")){case"button":c.attr("data-size")?d.removeClass("tve_smallBtn tve_normalBtn tve_bigBtn tve_hugeBtn"):d.removeClass("tve_btn1 tve_btn2 tve_btn3 tve_btn4 tve_btn5 tve_btn6 tve_btn7 tve_btn8"),d.find("i").css("width","").css("font-size","");break;case"table_cell":tve_event_change(a("input#table_inner_border").prop("checked",!0),d.parents(".thrv_table").first(),"table");break;case"lightbox":d=d.add(d.find(".tve_p_lb_close")),tve_path_params.tve_globals.l_cbs=f;break;case"bullets":d.removeClass("tve_ul1 tve_ul2 tve_ul3 tve_ul4 tve_ul5 tve_ul6");break;case"feature_grid":d.removeClass("tve_gr1 tve_gr2 tve_gr3");break;case"contentbox":d.removeClass("tve_sb_bot");break;case"icon":d=d.parent();break;case"widget_menu":d.removeClass("tve_left tve_center tve_right"),d.find("h2").removeClass("tve_p_left tve_p_center tve_p_right").addClass(f.replace("tve_","tve_p_"));break;case"lead_generation_radio":d=d.find(".tve_lg_radio"),d.removeClass("tve_lg_column1 tve_lg_column2 tve_lg_column3 tve_lg_column4 tve_lg_column5 tve_lg_column6 tve_lg_column7 tve_lg_column8 tve_lg_column9 tve_lg_column10");break;case"countdown_timer":case"countdown_timer_evergreen":d.removeClass("tve_countdown_1 tve_countdown_2 tve_countdown_3"),setTimeout(function(){var a="tve_"+c.data("type");d[a]().update()},1);break;case"fill_counter":c.attr("data-size")&&d.removeClass("tve_smallfc tve_normalfc tve_bigfc");break;case"page_section":d=d.find(".out").first();break;case"responsive_video":d.removeClass(rv_styles)}return c.attr("data-border")&&d.removeClass(b),d.addClass(f),tve_set_selected_dropdown(c),!1},style_family:function(a){hide_sub_menu(),tve_change_style_family(a.text()),tve_set_selected_dropdown(a)},web_safe_font:function(a,b,c){var d=get_shortcode_type_from_edit_mode(b);if("button"===d){var e=b.find("a"),f=b.find(".tve_btn_txt, .tve_btn_text");e.removeClass(custom_font_classes),e.attr("data-web-font",a.attr("data-web-font")),f.removeClass(custom_font_classes),f.attr("data-web-font",a.attr("data-web-font")),this.css(a,e),this.css(a,f)}else if("post_grid"===d){var g=b.find(".tve-post-grid-title");g.removeClass(custom_font_classes),this.css(a,g),b.tve_post_grid().config().update(a.attr("data-val"),"font-family"),b.tve_post_grid().config().update("","custom-font-class"),b.tve_post_grid().after_render()}else if("widget_menu"===d){b.find(".thrive-shortcode-html > ul").removeClass(custom_font_classes);var h=b.find("li");h.removeClass(custom_font_classes),this.css(a,h.find("a")),b.tve_widget_menu().set(a.attr("data-val"),"font_family").set("","font_class")}else b.removeClass(custom_font_classes),b.attr("data-web-font",a.attr("data-web-font")),this.css(a,b);tve_set_selected_dropdown(a)},remove_user_template:function(a){if(!confirm(tve_path_params.translations.RemoveContentTemplate))return!0;var b={action:"tve_remove_user_template",template_key:a.parent().find(".tpl_key").val(),security:tve_path_params.tve_ajax_nonce};return jQuery.post(tve_path_params.ajax_url,b,function(b){var c=a.parents("ul").first();a.parent().remove(),0===a.parent().find("li.cp_draggable").length&&a.parent().find("li.hide-on-tpl-save").show(),tve_add_notification("Template deleted!"),c.html(b),c.find("li.cp_draggable").each(function(){TVE_Content_Builder.drag.make_draggable(this)})}),!0},change_pattern:function(b){var c,d=b.attr("data-pattern"),e=b.find("input").attr("1"===d?"data-image":"id"),f=b.attr("data-plugin");if("1"===d)a(".edit_mode")[f]().setBgPattern(e);else if("2"===d){if(c)return c.open(),!1;c=wp.media({title:"Select or Upload Media for background patterns",button:{text:"Select Pattern"},multiple:!1,frame:"select",library:{type:["image/png","image/jpeg"]}}),c.on("select",function(){var b=c.state().get("selection").first().toJSON();a(".edit_mode")[f]().setBgPattern(b.url)}),c.open()}else a(".edit_mode")[f]().setBgColor(e);return!1},add_toggle:function(b,c){var d=c.find(".tve_faq").first().html();a(c).append("<div class='tve_faq active_toggle'></div>");var e=a(".active_toggle").html(d).removeClass("active_toggle");e.find(".tve_faqC").html("<p>Add your content here</p>").css("display","none"),TVE_Content_Builder.drag.ensure_dropzones(e.find(".tve_faqC p")),TVE_Content_Builder.drag.bind_draggable(e.find(".tve_faqC"))},reorder_toggle:function(b,c){c.addClass("tve_focus_element");var d=c.offset(),e=a("#tve_toggle_reorder_menu");e.css({left:d.left+"px"});var f=jQuery("body").offset().top;isNaN(f)&&(f=0),a.when(e.show(0)).done(function(){e.css("top",d.top-f-40+"px")}),hide_control_panel_menu(),TVE_Editor_Page.disable(),c.find(".tve_faqC").hide(),c.find("> .tve_faq").removeClass("tve_oFaq").parent().sortable({tolerance:"pointer",axis:"y"}),a("html,body").tve_css("overflow-x","visible","important")},reorder_toggle_done:function(b,c){a("#tve_toggle_reorder_menu").hide(),c.removeClass("tve_focus_element").sortable("destroy"),a(TVE_Editor_Page).unbind("editor.onenable"),TVE_Editor_Page.enable(),load_control_panel_menu(c[0],"toggle"),a("html,body").css("overflow-x","")},collapse_editor:function(){a("#tve_cpanel,body").toggleClass("tve_editor_collapse"),a(".tve_wrap_inner").toggleClass("tve_is_collapsed"),hide_sub_menu()},flip_editor:function(){tve_menu_position(a("#tve_cpanel").hasClass("tve_cpanelFlip")?"right":"left")},flip_editor_color:function(){tve_menu_color(a("#tve_cpanel").hasClass("tve_is_dark")?"light":"dark")},toggle_menu:function(a,b,c,d,e,f){var g=c.parents(".tve_menu").first().parent(),h=g.find("#"+a+"_menu");g.find(".tve_lg_custom_menu:visible").slideUp(200),h.is(":visible")||(h.slideDown(200),load_button_values(d.find(b),a))},save_reminders:function(a,b){a=parseInt(a);var c={action:"tve_ajax_update_option",option_name:"tve_display_save_notification",option_value:a,security:tve_path_params.tve_ajax_nonce,dataType:"json"};TVE_Editor_Page.overlay(),jQuery.post(tve_path_params.ajax_url,c,function(c){TVE_Editor_Page.overlay("close"),c=JSON.parse(c),c&&(a?(tve_path_params.tve_display_save_notification=a,TVE_Editor_Page.enableSaveWarning(),tve_add_notification("Save Reminders are turned On",!1,3e3)):(TVE_Editor_Page.disableSaveWarning(),tve_path_params.tve_display_save_notification=a,tve_add_notification("Save Reminders are turned Off",!1,3e3)),b.find("span").text(1===a?"Off":"On"),b.attr("data-args",1===a?0:1))})}},change:{element_id:function(a,b){b.is(".tve_content_inner")&&(b=b.parent()),b.attr("id",a.val())},link_name:function(a,b){b.find(".tve_active_hyperlink").attr("name",a.val())},link_url:function(b,c){var d=b.val();b.val(d),c.find("a.tve_btnLink").attr("href",d),a(".cta_test_link:visible").length&&a(".cta_test_link").attr("href",d),a(".tve_active_hyperlink").attr("href",d)},link_text:function(b,c){"button"==b.data("type")?c.find("a .tve_btn_txt, a .tve_btn_text").length?c.find("a .tve_btn_txt, a .tve_btn_text").last().text(b.val()):c.find("a").contents().last()[0].textContent=b.val():a(".tve_active_hyperlink").text(b.val())},link_target:function(b,c){var d=b.is(":checked")?"_blank":"_self";c.find("a.tve_btnLink").attr("target",d),a(".tve_active_hyperlink").attr("target",d)},link_rel:function(b,c){var d=b.is(":checked")?b.attr("data-value"):"";c.find("a.tve_btnLink").attr("rel",d),a(".tve_active_hyperlink").attr("rel",d)},id:function(b){var c=a(".edit_mode");c.attr("id",b.val())},cls:function(b,c){var d=a(".edit_mode");"string"==typeof b&&(d=jQuery(b),b=c),d.removeClass(function(a,b){var c="";b=b.split(" ");for(var d,a=0;d=b[a++];)-1===d.indexOf("thrv_")&&-1===d.indexOf("tve_")&&-1===thrv_custom_classes.indexOf(d)&&-1===custom_font_classes.indexOf(d)&&(c+=(c?" ":"")+d);return c}),d.addClass(b.val())},cc:function(a,b){b.find(".tve_"+a.attr("id")).css("display",a.is(":checked")?"block":"none")},cc_in_btn:function(a,b){a.prop("checked")?jQuery.post(tve_path_params.shortcodes_dir+"sc_cc_icons.php",{colour:window.last_colour_used,cssdir:tve_path_params.editor_dir},function(a){b.after(a)}):b.parent().find(".thrv_cc_icons").remove()},countdown_no_restart:function(a,b){var c=0;a.is(":checked")?(c=1,a.parents(".tve_sub").find(".tve_countdown_time").fadeOut("fast")):a.parents(".tve_sub").find(".tve_countdown_time").fadeIn("fast"),b.tve_countdown_timer_evergreen().set("norestart",c)},translate:function(a,b,c,d){var e=b.val();c.find(a).text(e.length?e:b.attr("placeholder"))},icon_text:function(a,b){b.text(a.val())},data_element_label:function(a,b){b.find(".tve_data_element_label").text(a.val())},data_element_percentage:function(a,b){a.val()>100||a.val()<0?a.addClass("tve_error_input"):a.removeClass("tve_error_input"),b.hasClass("thrv_progress_bar")?b.find(".tve_progress_bar_fill_wrapper").attr("data-fill",a.val()).css("width",a.val()+"%"):b.hasClass("thrv_fill_counter")&&b.find(".tve_fill_counter").attr("data-fill",1.8*a.val())},data_element_font_size:function(a,b){if(b.hasClass("thrv_progress_bar")){var c=tve_handle_integer_or_float(a.val());b.find(".tve_progress_bar").css("font-size",c+"px")}else if(b.hasClass("thrv_fill_counter")){var c=tve_handle_integer_or_float(a.val());b.find(".tve_data_element_label").css("font-size",c+"px")}else if(b.hasClass("thrv_number_counter")){var c=tve_handle_integer_or_float(a.val());b.find(".tve_data_element_label").css("font-size",c+"px")}},data_element_line_height:function(a,b){var c=tve_handle_integer_or_float(a.val());b.find(".tve_data_element_label").css("line-height",c+"px")},data_element_value:function(a,b){b.hasClass("thrv_fill_counter")?b.find(".tve_fill_text").text(a.val()):b.hasClass("thrv_number_counter")&&(a.val()<0?a.addClass("tve_error_input"):a.removeClass("tve_error_input"),"tve_data_element_value_start"===a.attr("id")?b.find(".tve_numberc_text").attr("data-counter-start",a.val()):b.find(".tve_numberc_text").text(a.val()).attr("data-counter",a.val()))},data_element_unit_b:function(a,b){b.hasClass("thrv_fill_counter")?b.find(".tve_fill_text_before").text(a.val()):b.hasClass("thrv_number_counter")&&b.find(".tve_numberc_before").text(a.val())},data_element_unit_a:function(a,b){b.hasClass("thrv_fill_counter")?b.find(".tve_fill_text_after").text(a.val()):b.hasClass("thrv_number_counter")&&b.find(".tve_numberc_after").text(a.val())},data_unit_font_size:function(a,b){if(b.hasClass("thrv_fill_counter")){var c=tve_handle_integer_or_float(a.val());b.find(".tve_fill_text_before, .tve_fill_text_after").css("font-size",c+"px")}else if(b.hasClass("thrv_number_counter")){var c=tve_handle_integer_or_float(a.val());b.find(".tve_numberc_before, .tve_numberc_after").css("font-size",c+"px")}},data_value_font_size:function(a,b){if(b.hasClass("thrv_fill_counter")){var c=tve_handle_integer_or_float(a.val());b.find(".tve_fill_text").css("font-size",c+"px")}else if(b.hasClass("thrv_number_counter")){var c=tve_handle_integer_or_float(a.val());b.find(".tve_numberc_text").css("font-size",c+"px")}},qs_tw_use_custom_url:function(a,b){var c=jQuery("#qs_tw_custom_url");a.is(":checked")?c.show():(c.hide(),b.removeAttr("data-custom_url")),b.tve_tw_qs().config("use_custom_url",a.is(":checked")?1:0)},qs_tw_url:function(a,b){b.tve_tw_qs().config("custom_url",a.val())}},mousedown:{test_image:function(a,b,c){c.preventDefault(),hide_control_panel_menu(),thrive_open_media(a,"load","testimonial_button",b)}},text:{remove_color:function(a,b){var c=a.attr("data-mode"),d=rangy.getSelection(),e="background"==c?"backgroundColor":"color",f="background"==c?"BackColor":"ForeColor";d.toString().length?(document.execCommand("removeFormat",!1,f),d.removeAllRanges()):(b.find("font").contents().unwrap(),b.css(e,""))}},pricing_table:{move:function(a,b){var c=b.find(".tve_hgh");if(0!==c.length){var d=c[a.attr("data-dir")](".tve_prt_col").addClass("tve_hgh");if(d.length){var e=d.find(".tve_prt_in"),f=c.find(".tve_prt_in"),g=e.attr("data-tve-custom-colour"),h=f.attr("data-tve-custom-colour");c.removeClass("tve_hgh"),g?f.attr("data-tve-custom-colour",g):f.removeAttr("data-tve-custom-colour"),h?e.attr("data-tve-custom-colour",h):e.removeAttr("data-tve-custom-colour")}}},highlight_toggle:function(a,b){var c=b.find(".tve_hgh").first();0===c.length?(b.find(".tve_prt_col").first().addClass("tve_hgh"),c=1):(c.removeClass("tve_hgh"),c=0),this.highlight_btn(a,b,c)},highlight_btn:function(a,b,c){"undefined"==typeof c&&(c=b.find(".tve_hgh").length),a.text(c?tve_path_params.translations.RemoveHighlightedColumn:tve_path_params.translations.AddHighlightedColumn)}},thrive_optin:{option:function(a,b){return b.tve_thrive_optin()[a.attr("data-fn")](a.attr("data-value")),tve_set_selected_dropdown(a),!1}},thrive_leads_shortcode:{option:function(a,b){return b.tve_thrive_leads_shortcode()[a.attr("data-fn")](a.attr("data-value")),tve_set_selected_dropdown(a),!1}},shadow:{blur:{inset_small:9,inset_medium:20,inset_large:50,small:2,medium:7,large:20},spread:{inset_small:-2,inset_medium:-5,inset_large:-15,small:0,medium:-2,large:-5},offset_matrix:{inset_small:7,inset_medium:20,inset_large:50,small:1,medium:7,large:20},position_matrix:{"inset_top-left":[1,1],inset_top:[0,1],"inset_top-right":[-1,1],inset_left:[1,0],inset_center:[0,0],inset_right:[-1,0],"inset_bottom-left":[1,-1],inset_bottom:[0,-1],"inset_bottom-right":[-1,-1],"top-left":[-1,-1],top:[0,-1],"top-right":[1,-1],left:[-1,0],center:[0,0],right:[1,0],"bottom-left":[-1,1],bottom:[0,1],"bottom-right":[1,1]},defaults:{i:{x:10,y:10,b:8,c:"rgba(0,0,0,0.7)",p:"inset_center"},o:{x:7,y:7,b:7,c:"rgba(0,0,0,0.7)",p:"center"}},current_element:null,$sliders:a(),on_menu_show:function(a,b){if(0!==a.find(".tve_shadow_control").length){this.$sliders=a.find(".tve_slider_shadow"),this.current_element=this.get_element(b,a.attr("id").replace("_menu","")),!this.current_element.data("shadow")&&this.current_element.css("box-shadow")&&"none"!==this.current_element.css("box-shadow")&&this.try_load_settings(this.current_element);var c=this.get_config(b,null);c&&c.i&&this.update_slider(!0,c.i),c&&c.o&&this.update_slider(!1,c.o)}},get_element:function(a,b){var c=tve_get_shortcode_wrapper_click(a),d=TVE_Content_Builder.colors.get_color_settings(b,c);if(!d)return a;for(var e,f=0;e=d[f++];)if("box-shadow-all"===e.value)return c.find(e.selector).first();return a},get_item_declaration:function(a){var b=-1!==a.p.indexOf("inset"),c=b?"inset ":"";return c+=parseInt(a.x*this.position_matrix[a.p][0])+"px",c+=" "+parseInt(a.y*this.position_matrix[a.p][1])+"px",c+=" "+a.b+"px",c+=-1!==a.p.indexOf("center")?" "+parseInt(a.b/2)+"px":" -"+parseInt(a.b/4)+"px",c+" "+a.c},position:function(a,b){var c=a.attr("data-coords"),d=-1!==c.indexOf("inset"),e=this.get_config(this.current_element,d),f=d?"i":"o";e[f].p=c,"transparent"==e[f].c&&(e[f].c=this.defaults[f].c),this.update_slider(d,e[f]),this.apply(e,this.current_element)},size:function(a,b){var c=a.attr("data-size"),d=a.attr("data-inset")?!0:!1,e=this.get_config(this.current_element,d),f=d?"i":"o",g=(d?"inset_":"")+c;e[f].x=this.offset_matrix[g],e[f].y=this.offset_matrix[g],e[f].b=this.blur[g],"transparent"==e[f].c&&(e[f].c=this.defaults[f].c),this.update_slider(d,e[f]),this.apply(e,this.current_element)},update_slider:function(a,b){var c=b.x?2*b.x:b.y?2*b.y:2*b.b;this.$sliders.filter(a?".tve_inset":".tve_outer").slider("value",c)},apply:function(b,c){var d=a.extend(!0,{},b);this.current_element.data("shadow",d);var e=this.get_css_values(b),f=tve_get_unique_css_identifier(c,!0);e=replaceAll("[css_values]",e,TVE_Content_Builder.colors.css_props["box-shadow-all"]),a.when(tve_remove_css_rule(f,"-webkit-box-shadow"),tve_remove_css_rule(f,"-moz-box-shadow"),tve_remove_css_rule(f,"box-shadow")).then(tve_add_css_rule('[data-tve-custom-colour="'+f+'"]',e,0))},get_config:function(b,c){var d=a.extend(!0,{},b.data("shadow"));if(null!==c){var e=c?"i":"o";d&&d[e]||(d=d||{},d[e]=a.extend({},this.defaults[e]),d[e].c=TVE_Content_Builder.colors.parse_box_shadow(b,{inset:c}).found_color[0],"transparent"==d[e].c&&(d[e].c=this.defaults[e].c),b.data("shadow",d))}return d},clear:function(a,b){var c=a.attr("data-inset")?!0:!1,d=this.get_config(this.current_element,c);delete d[c?"i":"o"],this.apply(d,this.current_element)},color_changed:function(b,c){var d=this.get_config(this.current_element,c);return d[c?"i":"o"].c=b,this.current_element.data("shadow",a.extend(!0,{},d)),d},inset_slider:function(a,b){var c=parseInt(b),d=this.get_config(this.current_element,!0);d.i.x=parseInt(c/2),d.i.y=parseInt(c/2),d.i.b=parseInt(c/2),this.apply(d,this.current_element)},outset_slider:function(a,b){var c=parseInt(b),d=this.get_config(this.current_element,!1);d.o.x=parseInt(c/2),d.o.y=parseInt(c/2),d.o.b=parseInt(c/2),this.apply(d,this.current_element)},get_css_values:function(a){var b="";return a.i&&(b+=this.get_item_declaration(a.i)),a.o&&(b+=(b?",":"")+this.get_item_declaration(a.o)),b},try_load_settings:function(b){var c=TVE_Content_Builder.colors.parse_box_shadow(b),d={};if(c.css_rules.i&&c.colors.i){var e=this.parse_shadow_size(c.css_rules.i,"inset_");e!==!1&&(d.i=e,d.i.c=c.colors.i)}if(c.css_rules.o&&c.colors.o){var e=this.parse_shadow_size(c.css_rules.o,"");e!==!1&&(d.o=e,d.o.c=c.colors.o)}this.current_element.data("shadow",a.extend({},!0,d))},parse_shadow_size:function(b,c){var d=b.split(" "),e=[],f={};return a.each(d,function(b,c){var d=parseInt(a.trim(c));isNaN(d)||e.push(d)}),e.length<2?!1:(0===e[0]&&0===e[1]?f.p=c+"center":a.each(this.position_matrix,function(a,b){if(tve_signum(b[0])===tve_signum(e[0])&&tve_signum(b[1])===tve_signum(e[1])){if(c&&0===a.indexOf("inset"))return f.p=a,!1;if(!c&&-1===a.indexOf("inset"))return f.p=a,!1}}),f.p?(e[2]||(e[2]=0),f.x=Math.abs(e[0]),f.y=Math.abs(e[1]),f.b=e[2],f):!1)}},filter_lp:function(a){return a.val()?(jQuery(".tve_landing_page_template").hide(),void jQuery('.tve_cell_caption:contains("'+a.val()+'")').parents(".tve_landing_page_template").css("display","")):void jQuery(".tve_landing_page_template").show()},widget_menu:{menu_changed:function(a,b){b.tve_widget_menu().set(a.attr("data-id"),"menu_id",!0),tve_set_selected_dropdown(a)},menu_type:function(a,b){b.tve_widget_menu().direction(a.attr("data-type")),tve_set_selected_dropdown(a)},title_change:function(a,b){b.tve_widget_menu().title(a.val())}},lead_generation:{reset_errors:function(a,b,c){var d=TVE_Editor_Page.thriveShrtcodeConfig(b.find(".thrv_lead_generation_errors"),"lead_generation"),e=a.parents(".tve_lg_errors"),f={email:"Please enter a valid email address",phone:"Please enter a valid phone number",required:"Highlighted fields are required"};d.save(f),e.find("#tve_lg_email_error").val(f.email),e.find("#tve_lg_phone_error").val(f.phone),e.find("#tve_lg_required_error").val(f.required)},heights_selector:function(){return'.edit_mode input[type="text"], .edit_mode select, .edit_mode textarea'},widths_selector:function(){return".edit_mode .tve_lg_input_container"},clear_inputs_heights:function(a,b){var c=tve_parse_ctrl_string(a),d=jQuery(c()),b=jQuery(b);return d.css("height",""),load_button_values(b,get_shortcode_type_from_edit_mode(b)),!0},clear_inputs_widths:function(a,b){var c=tve_parse_ctrl_string(a),d=jQuery(c()),b=jQuery(b);return d.css("max-width",""),load_button_values(b,get_shortcode_type_from_edit_mode(b)),!0},dropdown_width_selector:function(){return".edit_mode .tve_lg_dropdown"},inputs_width_selector:function(){return".edit_mode .tve_lg_input"},radio_width_selector:function(){return".edit_mode .tve_lg_radio"},checkbox_width_selector:function(){return".edit_mode .tve_lg_checkbox"},textarea_width_selector:function(){return".edit_mode .tve_lg_textarea"},textarea_height_selector:function(){return".edit_mode textarea"},button_submit_width_selector:function(){return".edit_mode .tve_submit_container"},image_submit_selector:function(){return'.edit_mode input[type="image"]'},clear_width:function(a,b,c,d,e){e.find(a).css("max-width",""),load_button_values(e.find(b),c)},clear_height:function(a,b,c,d,e){e.find(a).css("height",""),load_button_values(e.find(b),c)},style:function(a,b){b.is("."+a.attr("id"))||(tve_set_selected_dropdown(a),b.tve_lead_generation().applyStyle(a.attr("id")))},add_border_style:function(a,c,d,e){d.find(a).removeClass(b).addClass(c.attr("id")),tve_set_selected_dropdown(c)}},post_grid:{design:function(a,b,c,d){var e=c.tve_post_grid(),f=e.config();return f.design===a?!0:(f.update(a,"design"),e.display(),!0)}},rollback:function(b,c,d){if(d.preventDefault(),b.is(".tve_disabled"))return!1;var e=b.attr("href");return TVE_Editor_Page.overlay(),a.get(e,function(){location.href=location.href}),!1},quick_link:{updateContentList:function(b,c,d){window.tve_quick_links_t&&clearTimeout(window.tve_quick_links_t),window.tve_quick_links_t=setTimeout(function(){b.addClass("tve_small_spinner");var c={action:"tve_find_quick_link_contents",q:b.val()};jQuery.post(tve_path_params.ajax_url,c,function(c){var d=a(".quick_link_content_table");d.html(c),b.removeClass("tve_small_spinner")})},200)},updateQuickLink:function(a,b,c){var d=a.parents(".tve_menu").first().parent(),e=a.parents(".tve_sub");a.hasClass("tve_select_quick_link_post")&&d.find(".tve_quick_link_input").val(a.attr("rel"));var f=[];f.lb_link_target=e.find(".lb_quick_link_target").is(":checked")?!0:!1,tve_path_params.lb_ql_link_target=f.lb_link_target,f.lb_no_follow=e.find(".lb_quick_link_no_follow").is(":checked")?!0:!1,tve_path_params.lb_ql_no_follow=f.lb_no_follow,f.lb_link=d.find(".tve_quick_link_input").val(),f.edited_element_type=get_shortcode_type_from_edit_mode(b),tve_prepare_hyperlink(f)}},responsive_video:{start_time_changed:function(a,b,c){var d,e=b.tve_responsive_video(),f=parseInt(a.parent().find("#responsive_video_start_min_time").val()),g=parseInt(a.parent().find("#responsive_video_start_sec_time").val());(isNaN(f)||0>f)&&(f=0),(isNaN(g)||0>g||g>60)&&(g=0),d=60*f+g,e.set(d,"start-time")},play_bar:function(a,b,c){var d=b.tve_responsive_video(),e=a.is(":checked")?"1":"0";d.set(e,"play-bar")},onload_controls:function(a,b,c){var d=b.tve_responsive_video(),e=a.is(":checked")?"1":"0";d.set(e,"onload-controls")}},landing_page_import:function(b){if(!window.tve_lp_import_confirmed&&!confirm(tve_path_params.translations.LPImportConfirm))return!1;if(window.tve_lp_import_confirmed=!0,TVE_Content_Builder.controls.lp_import_frame)return void TVE_Content_Builder.controls.lp_import_frame.open();TVE_Content_Builder.controls.lp_import_frame=wp.media.frames.file_frame=wp.media({title:b.data("title"),button:{text:b.data("btntitle")},multiple:!1,frame:"select",library:{type:"application/zip"}});var c=TVE_Content_Builder.controls.lp_import_frame;TVE_Content_Builder.controls.lp_import_frame.on("select",function(){var b=c.state().get("selection").first().toJSON();return"application/zip"!==b.mime?(tve_add_notification("Only .zip files are allowed",!0),void TVE_Content_Builder.controls.lp_import_frame.open()):(TVE_Editor_Page.overlay(),void a.post(tve_path_params.ajax_url,{attachment_id:b.id,action:"tve_lp_import",page_id:tve_path_params.post_id},function(a){return a.success?(window.onbeforeunload=null,void(location.href=a.url)):(TVE_Editor_Page.overlay(!0),tve_add_notification(a.message,!0,8e3),void TVE_Content_Builder.controls.lp_import_frame.open())},"json").fail(function(a){TVE_Editor_Page.overlay(!0),tve_add_notification(tve_path_params.translations.UnknownError+a.responseText,!0,1e4),TVE_Content_Builder.controls.lp_import_frame.open()}).always(function(){}))}),c.on("content:render:upload",function(){jQuery(".post-upload-ui .tve-media-allowed-zip").show()}),TVE_Content_Builder.controls.lp_import_frame.open()},lp_export_thumb:function(b){var c=a("body").addClass("mce_open"),d=b.parent();thrive_open_media(null,"","simple_image",d.find("img.tve-lp-thumb"),function(a){d.find("input.lp-export-attachment").val(a.id),c.removeClass("mce_open"),d.find(".tve-lp-remove-thumb").show()})},lp_export_remove_thumb:function(a){var b=a.parent();b.find("img.tve-lp-thumb").attr("src","").hide(),b.find("input.lp-export-attachment").val(""),a.hide()}},rangy.tve_get_selection_node=function(a){var b,c,d=this.getSelection();return d.rangeCount>0?(b=d.getRangeAt(0),c=b.commonAncestorContainer,3==c.nodeType&&(c=c.parentNode),"undefined"==typeof a||jQuery.contains(a[0],c)?jQuery(c):jQuery()):jQuery()}}(jQuery);