/*! Thrive Clever Widgets 2015-08-19
* http://www.thrivethemes.com 
* Copyright (c) 2015 * Thrive Themes */
var tcw_app=tcw_app||{};!function(){"use strict";tcw_app.TabContentView=Backbone.View.extend({actionContainerClass:"tcw_actionContainer",actionDefaultClass:"tcw_tabAction",events:{"click .selectAll":"checkAll","click .selectNone":"checkNone","click .tcw_addDirectLink":"addDirectLinkClicked","keypress .tcw_directUrl":"addDirectLinkClicked"},initialize:function(){this.listenTo(this.model.get("options"),"add",function(){this.renderOptions(),this.model.trigger("change")}),this.listenTo(this.model.get("options"),"remove",function(){this.renderOptions(),this.model.trigger("change")})},renderOthersTab:function(){return this.$el.addClass(this.model.getTabContentIdentifier()).addClass("tcw_tabs_content").addClass("tcw_clearfix").append("<h2>Visitor Status</h2>").append('<div class="tcw-visitor-status clearfix"></div>').append('<div class="clear"></div><h2>Direct URLs</h2>').append('<div class="tcw-direct-urls tcw_tab_content_direct_urls clearfix"></div>'),this.renderOptionsOthers(),this.renderAddDirectUrlForm(),this},renderOptionsOthers:function(){this.$el.find(".tcw-visitor-status").empty(),this.$el.find(".tcw-direct-urls").empty();var a=this;_.each(this.model.get("options").models,function(b){var c=a.$el.find("direct_url"==b.get("type")?".tcw-direct-urls":".tcw-visitor-status"),d=new tcw_app.OptionView({model:b});c.append(d.el),d.render(),b.on("change:isChecked",function(){a.model.trigger("change")})})},render:function(){return"others"===this.model.get("identifier")?this.renderOthersTab():(this.$el.addClass(this.model.getTabContentIdentifier()).addClass("tcw_tabs_content").addClass("tcw_clearfix").append("<h2>"+this.model.get("label")+"</h2>"),this.renderActions(),"direct_urls"===this.model.get("identifier")&&this.renderAddDirectUrlForm(),this.renderOptions(),void this.renderFilters())},renderOptions:function(){if("others"===this.model.get("identifier"))return this.renderOptionsOthers();this.$el.find(".tcw_optionContainer").remove();var a=this;_.each(this.model.get("options").models,function(b){a.renderOption(b),b.on("change:isChecked",function(){a.model.trigger("change")})})},renderOption:function(a){var b=new tcw_app.OptionView({model:a});this.$el.append(b.el),b.render()},renderActions:function(){if(this.model.get("actions").length){var a=jQuery('<div class="'+this.actionContainerClass+' tcw_clearfix" />'),b=this;this.$el.append(a),this.model.get("actions").length&&_.each(this.model.get("actions"),function(a){b.$el.find("."+b.actionContainerClass).append('<a class="'+b.actionDefaultClass+" "+a.cssClass+'" href="javascript:void(0)">'+a.label+"</a>")})}},renderFilters:function(){if(this.model.get("filters").length){var a=new tcw_app.FiltersView({model:this.model,collection:this.model.get("filters")});a.render(),this.$el.find("h2").after(a.el),a.filterClicked(a.$el.children().first())}},renderAddDirectUrlForm:function(){var a=_.template(jQuery("#add-direct-url-form-template").html());this.$el.append(a)},checkAll:function(){_.each(this.model.get("options").models,function(a){a.check()})},checkNone:function(){_.each(this.model.get("options").models,function(a){a.uncheck()})},addDirectLinkClicked:function(a){if("keypress"!==a.type||13===a.which){var b=jQuery(a.target),c=b.parent(),d=c.find("input");this.model.get("options").add({id:d.val().trim(),label:d.val().trim(),type:"direct_url"},{validate:!0}),d.val("")}}})}(jQuery);